<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="./css/view.css">
    <link rel="stylesheet" type="text/css" href="DataTables-1.10.18/css/jquery.dataTables.css"/>
</head>
<body>
   <header></header>
<div class="reg" id='app'>
    <div class="header">
        <h1>
            <a href="/main.jsp" style="margin-left: 0">return</a>
        </h1>
        <h1 style="margin-left: 200px">
           look around.
        </h1>
    </div>
    <div v-for="item in list">
       <!--
       <a v-bind:href='"detail.html?id=" + item.id' class='title'>{{item.title}}</>
       -->
       <a v-bind:href="'detail.html?id=' + item.id" class='title'>
          (&nbsp{{(item.title === undefined || item.title.length===0)? item.id : item.title}}&nbsp)
       </a>
       <div>{{item.content}}</div>
       <br/>
    </div>
    <div>
       <a class='page' v-on:click="previous">previous</a>
       <a class='page' v-on:click="next">next</a>
    </div>
</div>

<style>
.page {
   padding-right: 2%;
}
</style>

    <script type="text/javascript" src="jquery-3.4.0.js"></script>
    <script type="text/javascript" src="DataTables-1.10.18/js/jquery.dataTables.js"></script>
    <script type="text/javascript" src="global.js"></script>
    <script type="text/javascript" src="util.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script type="text/javascript">
            ////
            include('/comp/header.html','header');
///
var app = new Vue({
   el: '#app',
   data: {
      list: [],
      page: 0,
      limit: 8,
      total: 1
   },
   methods: {
      previous: function(event) {
         var scope = this;
         if(scope.page <= 0){
            scope.page = 0;
            return;
         }
         scope.page = scope.page -1;
         scope.refresh();
      },
      next: function(event) {
         var scope = this;
         if(scope.page >= scope.total - 1){
            scope.page = scope.total - 1;
            return;
         }
         scope.page = scope.page + 1;
         scope.refresh();
      },
      refresh: function(){
         var scope = this;
         $.ajax({
            url: _url_posts,
            data: {
               offset: scope.page,
               limit: scope.limit
            },
            success: function(dat,stat, xhr){
               if (stat === 'nocontent'){
                  alert(stat);
                  return;
               }
               scope.list = dat.payload;
            },
            error: function(xhr, stat){
               alert(xhr.status);
            }
         });
      }
   },
   mounted: function(){
      var scope = this;
      scope.refresh();
   }
});
    </script>
</body>
</html>
